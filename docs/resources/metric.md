---
page_title: "ngg_metric Resource - terraform-provider-ngg"
subcategory: ""
description: |- Nvidia GPU Guardian metric. A periodic measurement of a system property.
---

# ngg_metric (Resource)

Nvidia GPU Guardian Metrics are time-series data obtained through tools such as Prometheus
and the Nvidia GPU Guardian Metric Scraper. In addition to
Nvidia GPU Guardian's standard Metrics you can define your own custom metrics using the `ngg_metric`
resource.

## Required Properties

A Metric has only a few required properties:

- name - A unique name for the metric resource.
- value - A valid Op statement that defines a valid Metric query.

## Usage

The following example creates a Metric named `avg_cpu_usage_prev_min` that gets the average CPU usage over
the last minute:

```tf
resource "ngg_metric" "avg_cpu_usage_prev_min" {
  name = "avg_cpu_usage_prev_min"
  value = "cpu_usage | window(60s) | mean(60)"
}
```

### Advanced Usage

You can also create your own Metric queries using any ingested metric known to the
associated Nvidia GPU Guardian Agent. In the following example we're using Elasticsearch's cluster health status to
create a custom `elasticsearch_red_status` Metric:

```tf
resource "ngg_metric" "elasticsearch_red_status" {
  name = "${var.namespace}_elasticsearch_red_status"
  value = "metric_query(metric_names=\"elasticsearch_cluster_health_status\") | color=\"red\""
  description = "Returns 1 if resource has status red else 0"
}
```

The `elasticsearch_red_status` Metric can now be used as the basis for an Alarm:

```tf
resource "ngg_alarm" "elasticsearch_status_alarm" {
  name = "${var.prefix}_elasticsearch_status_alarm"
  fire_query = "${ ngg_metric.elasticsearch_red_status.name} == 1"
  clear_query = "${ ngg_metric.elasticsearch_red_status.name} == 0"
  description = "Watch Elasticsearch health status."
  resource_query = "pods"
  enabled = true
}
```

-> See the Nvidia GPU Guardian Metrics and Metric Scraper documentation
for more info.

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `name` (String) The name/symbol for the object within Shoreline and the op language (must be unique, only alphanumeric/underscore).
- `value` (String) The Op statement that defines a Metric or Resource.

### Optional

- `description` (String) A user-friendly explanation of an object.
- `resource_type` (String)
- `units` (String) Units of a Metric (e.g., bytes, blocks, packets, percent).

### Read-Only

- `id` (String) The ID of this resource.
- `type` (String) The type of object (i.e., Alarm, Action, Bot, Metric, Resource, or File).

